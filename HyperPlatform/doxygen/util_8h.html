<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>HyperPlatform: HyperPlatform/util.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HyperPlatform
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_16fcf1458aec6cdcd2284700b6c28d4a.html">HyperPlatform</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">util.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declares interfaces to utility functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ia32__type_8h_source.html">ia32_type.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for util.h:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h__incl.png" border="0" usemap="#_hyper_platform_2util_8h" alt=""/></div>
<map name="_hyper_platform_2util_8h" id="_hyper_platform_2util_8h">
<area shape="rect" id="node2" href="ia32__type_8h.html" title="Ddefines constants and structures defined by the x86&#45;64 archtecture. " alt="" coords="110,80,199,107"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h__dep__incl.png" border="0" usemap="#_hyper_platform_2util_8hdep" alt=""/></div>
<map name="_hyper_platform_2util_8hdep" id="_hyper_platform_2util_8hdep">
<area shape="rect" id="node2" href="driver_8cpp.html" title="Implements an entry point of the driver. " alt="" coords="5,80,168,107"/>
<area shape="rect" id="node3" href="ept_8cpp.html" title="Implements EPT functions. " alt="" coords="193,80,343,107"/>
<area shape="rect" id="node4" href="util_8cpp.html" title="Implements primitive utility functions. " alt="" coords="367,80,518,107"/>
<area shape="rect" id="node5" href="vm_8cpp.html" title="Implements VMM initialization functions. " alt="" coords="543,80,692,107"/>
<area shape="rect" id="node6" href="vmm_8cpp.html" title="Implements VMM functions. " alt="" coords="716,80,876,107"/>
</map>
</div>
</div>
<p><a href="util_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_physical_memory_run.html">PhysicalMemoryRun</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents ranges of addresses.  <a href="struct_physical_memory_run.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_physical_memory_descriptor.html">PhysicalMemoryDescriptor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Represents a physical memory ranges of the system.  <a href="struct_physical_memory_descriptor.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a939581b1de686b22b77e05cc403bfefc"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a> : unsigned __int8 { <a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefcae69fa9a656f76dd8a4d89f21992b2d3a">VmxStatus::kOk</a> = 0, 
<a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefcaf22dc5a4d384163b7540729085d894c1">VmxStatus::kErrorWithStatus</a> = 1, 
<a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefca7bfc9e82422c34b573095e24a83b7315">VmxStatus::kErrorWithoutStatus</a> = 2
 }<tr class="memdesc:a939581b1de686b22b77e05cc403bfefc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates a result of VMX-instructions.  <a href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">More...</a><br /></td></tr>
<tr class="separator:a939581b1de686b22b77e05cc403bfefc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2d891c866238ad21fd5cba7d10394d40"><td class="memItemLeft" align="right" valign="top">constexpr <a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a2d891c866238ad21fd5cba7d10394d40">operator|=</a> (_In_ <a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a> lhs, _In_ <a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a> rhs)</td></tr>
<tr class="memdesc:a2d891c866238ad21fd5cba7d10394d40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provides |= operator for VmxStatus.  <a href="#a2d891c866238ad21fd5cba7d10394d40">More...</a><br /></td></tr>
<tr class="separator:a2d891c866238ad21fd5cba7d10394d40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a726bcdba2e49ace860d6de5f443f5253"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a726bcdba2e49ace860d6de5f443f5253">UtilInitialization</a> ()</td></tr>
<tr class="memdesc:a726bcdba2e49ace860d6de5f443f5253"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes the Util functions ready for use.  <a href="#a726bcdba2e49ace860d6de5f443f5253">More...</a><br /></td></tr>
<tr class="separator:a726bcdba2e49ace860d6de5f443f5253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9eec12475580085fab5c154f681d59a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a9eec12475580085fab5c154f681d59a5">UtilTermination</a> ()</td></tr>
<tr class="memdesc:a9eec12475580085fab5c154f681d59a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees all resources allocated for the sake of the Util funcions.  <a href="#a9eec12475580085fab5c154f681d59a5">More...</a><br /></td></tr>
<tr class="separator:a9eec12475580085fab5c154f681d59a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9689b4a580d88e9e516e6081795de0d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="struct_physical_memory_descriptor.html">PhysicalMemoryDescriptor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#ab9689b4a580d88e9e516e6081795de0d">UtilGetPhysicalMemoryRanges</a> ()</td></tr>
<tr class="memdesc:ab9689b4a580d88e9e516e6081795de0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns ranges of physical memory on the system.  <a href="#ab9689b4a580d88e9e516e6081795de0d">More...</a><br /></td></tr>
<tr class="separator:ab9689b4a580d88e9e516e6081795de0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aaa003c42756a8d0d878a024157ae61"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a0aaa003c42756a8d0d878a024157ae61">UtilForEachProcessor</a> (_In_ NTSTATUS(*callback_routine)(void *), _In_opt_ void *context)</td></tr>
<tr class="memdesc:a0aaa003c42756a8d0d878a024157ae61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes <em>callback_routine</em> on each processor.  <a href="#a0aaa003c42756a8d0d878a024157ae61">More...</a><br /></td></tr>
<tr class="separator:a0aaa003c42756a8d0d878a024157ae61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3191572ccb702eea4c5845531d009ad"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#aa3191572ccb702eea4c5845531d009ad">UtilSleep</a> (_In_ LONG millisecond)</td></tr>
<tr class="memdesc:aa3191572ccb702eea4c5845531d009ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suspends the execution of the current thread.  <a href="#aa3191572ccb702eea4c5845531d009ad">More...</a><br /></td></tr>
<tr class="separator:aa3191572ccb702eea4c5845531d009ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32e9f8e1d8f7224f39defe4075d64fd1"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a32e9f8e1d8f7224f39defe4075d64fd1">UtilMemMem</a> (_In_ const void *search_base, _In_ SIZE_T search_size, _In_ const void *pattern, _In_ SIZE_T pattern_size)</td></tr>
<tr class="memdesc:a32e9f8e1d8f7224f39defe4075d64fd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searchs a byte pattern from a given address range.  <a href="#a32e9f8e1d8f7224f39defe4075d64fd1">More...</a><br /></td></tr>
<tr class="separator:a32e9f8e1d8f7224f39defe4075d64fd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4010ee7a299cbcb6c0aaf1290d5a7a73"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a4010ee7a299cbcb6c0aaf1290d5a7a73">UtilGetSystemProcAddress</a> (_In_ const wchar_t *proc_name)</td></tr>
<tr class="memdesc:a4010ee7a299cbcb6c0aaf1290d5a7a73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get an address of an exported symbol by the kernel or HAL.  <a href="#a4010ee7a299cbcb6c0aaf1290d5a7a73">More...</a><br /></td></tr>
<tr class="separator:a4010ee7a299cbcb6c0aaf1290d5a7a73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8434ca108fb47650842faded523d9c4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#ad8434ca108fb47650842faded523d9c4">UtilIsX86Pae</a> ()</td></tr>
<tr class="memdesc:ad8434ca108fb47650842faded523d9c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the system is a PAE-enabled x86 system.  <a href="#ad8434ca108fb47650842faded523d9c4">More...</a><br /></td></tr>
<tr class="separator:ad8434ca108fb47650842faded523d9c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08e9aad496c6e45b9736641659914975"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a08e9aad496c6e45b9736641659914975">UtilIsAccessibleAddress</a> (_In_ void *address)</td></tr>
<tr class="memdesc:a08e9aad496c6e45b9736641659914975"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks is the address is present on physical memory.  <a href="#a08e9aad496c6e45b9736641659914975">More...</a><br /></td></tr>
<tr class="separator:a08e9aad496c6e45b9736641659914975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92592f53709118b3e50ee7ae7229740d"><td class="memItemLeft" align="right" valign="top">ULONG64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a92592f53709118b3e50ee7ae7229740d">UtilPaFromVa</a> (_In_ void *va)</td></tr>
<tr class="memdesc:a92592f53709118b3e50ee7ae7229740d"><td class="mdescLeft">&#160;</td><td class="mdescRight">VA -&gt; PA.  <a href="#a92592f53709118b3e50ee7ae7229740d">More...</a><br /></td></tr>
<tr class="separator:a92592f53709118b3e50ee7ae7229740d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae40894c3616c3b42f07abe8f7318c843"><td class="memItemLeft" align="right" valign="top">PFN_NUMBER&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#ae40894c3616c3b42f07abe8f7318c843">UtilPfnFromVa</a> (_In_ void *va)</td></tr>
<tr class="memdesc:ae40894c3616c3b42f07abe8f7318c843"><td class="mdescLeft">&#160;</td><td class="mdescRight">VA -&gt; PFN.  <a href="#ae40894c3616c3b42f07abe8f7318c843">More...</a><br /></td></tr>
<tr class="separator:ae40894c3616c3b42f07abe8f7318c843"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a647d0431c628fe6bceb8f14bc94b21b6"><td class="memItemLeft" align="right" valign="top">PFN_NUMBER&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a647d0431c628fe6bceb8f14bc94b21b6">UtilPfnFromPa</a> (_In_ ULONG64 pa)</td></tr>
<tr class="memdesc:a647d0431c628fe6bceb8f14bc94b21b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">PA -&gt; PFN.  <a href="#a647d0431c628fe6bceb8f14bc94b21b6">More...</a><br /></td></tr>
<tr class="separator:a647d0431c628fe6bceb8f14bc94b21b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09515f13e88dde436aa2c096765af41c"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a09515f13e88dde436aa2c096765af41c">UtilVaFromPa</a> (_In_ ULONG64 pa)</td></tr>
<tr class="memdesc:a09515f13e88dde436aa2c096765af41c"><td class="mdescLeft">&#160;</td><td class="mdescRight">PA -&gt; VA.  <a href="#a09515f13e88dde436aa2c096765af41c">More...</a><br /></td></tr>
<tr class="separator:a09515f13e88dde436aa2c096765af41c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab74c0627dc9924818519701853229222"><td class="memItemLeft" align="right" valign="top">ULONG64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#ab74c0627dc9924818519701853229222">UtilPaFromPfn</a> (_In_ PFN_NUMBER pfn)</td></tr>
<tr class="memdesc:ab74c0627dc9924818519701853229222"><td class="mdescLeft">&#160;</td><td class="mdescRight">PNF -&gt; PA.  <a href="#ab74c0627dc9924818519701853229222">More...</a><br /></td></tr>
<tr class="separator:ab74c0627dc9924818519701853229222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab201d9452d8e211487bdf98032190b3d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#ab201d9452d8e211487bdf98032190b3d">UtilVaFromPfn</a> (_In_ PFN_NUMBER pfn)</td></tr>
<tr class="memdesc:ab201d9452d8e211487bdf98032190b3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">PNF -&gt; VA.  <a href="#ab201d9452d8e211487bdf98032190b3d">More...</a><br /></td></tr>
<tr class="separator:ab201d9452d8e211487bdf98032190b3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd8f1299edde15aad1cfba8551fc32f"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a8bd8f1299edde15aad1cfba8551fc32f">UtilAllocateContiguousMemory</a> (_In_ SIZE_T number_of_bytes)</td></tr>
<tr class="memdesc:a8bd8f1299edde15aad1cfba8551fc32f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates continuous physical memory.  <a href="#a8bd8f1299edde15aad1cfba8551fc32f">More...</a><br /></td></tr>
<tr class="separator:a8bd8f1299edde15aad1cfba8551fc32f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2473b98f948abe5e903993c0ce37ed7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a2473b98f948abe5e903993c0ce37ed7e">UtilFreeContiguousMemory</a> (_In_ void *base_address)</td></tr>
<tr class="memdesc:a2473b98f948abe5e903993c0ce37ed7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees an address allocated by <a class="el" href="util_8h.html#a8bd8f1299edde15aad1cfba8551fc32f" title="Allocates continuous physical memory. ">UtilAllocateContiguousMemory()</a>  <a href="#a2473b98f948abe5e903993c0ce37ed7e">More...</a><br /></td></tr>
<tr class="separator:a2473b98f948abe5e903993c0ce37ed7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b65dcf2f010be518a04a714117d76b3"><td class="memItemLeft" align="right" valign="top">NTSTATUS&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a4b65dcf2f010be518a04a714117d76b3">UtilVmCall</a> (_In_ ULONG_PTR hypercall_number, _In_opt_ void *context)</td></tr>
<tr class="memdesc:a4b65dcf2f010be518a04a714117d76b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes VMCALL.  <a href="#a4b65dcf2f010be518a04a714117d76b3">More...</a><br /></td></tr>
<tr class="separator:a4b65dcf2f010be518a04a714117d76b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaef3fe7b88b1a88248877c717dac8ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#adaef3fe7b88b1a88248877c717dac8ea">UtilDumpGpRegisters</a> (_In_ const <a class="el" href="struct_all_registers.html">AllRegisters</a> *all_regs, _In_ ULONG_PTR stack_pointer)</td></tr>
<tr class="memdesc:adaef3fe7b88b1a88248877c717dac8ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Debug prints registers.  <a href="#adaef3fe7b88b1a88248877c717dac8ea">More...</a><br /></td></tr>
<tr class="separator:adaef3fe7b88b1a88248877c717dac8ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a146843c664ad83867ad5063ea122bc64"><td class="memItemLeft" align="right" valign="top">ULONG_PTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a146843c664ad83867ad5063ea122bc64">UtilVmRead</a> (_In_ <a class="el" href="ia32__type_8h.html#a46733ebfd60eed3f1539af888cb983cb">VmcsField</a> field)</td></tr>
<tr class="memdesc:a146843c664ad83867ad5063ea122bc64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads natural-width VMCS.  <a href="#a146843c664ad83867ad5063ea122bc64">More...</a><br /></td></tr>
<tr class="separator:a146843c664ad83867ad5063ea122bc64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53c0c66fa501f754e718e27e559cd6c0"><td class="memItemLeft" align="right" valign="top">ULONG64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a53c0c66fa501f754e718e27e559cd6c0">UtilVmRead64</a> (_In_ <a class="el" href="ia32__type_8h.html#a46733ebfd60eed3f1539af888cb983cb">VmcsField</a> field)</td></tr>
<tr class="memdesc:a53c0c66fa501f754e718e27e559cd6c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads 64bit-width VMCS.  <a href="#a53c0c66fa501f754e718e27e559cd6c0">More...</a><br /></td></tr>
<tr class="separator:a53c0c66fa501f754e718e27e559cd6c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aac44909f0ed34200901dc0fbb44b09"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a1aac44909f0ed34200901dc0fbb44b09">UtilVmWrite</a> (_In_ <a class="el" href="ia32__type_8h.html#a46733ebfd60eed3f1539af888cb983cb">VmcsField</a> field, _In_ ULONG_PTR field_value)</td></tr>
<tr class="memdesc:a1aac44909f0ed34200901dc0fbb44b09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes natural-width VMCS.  <a href="#a1aac44909f0ed34200901dc0fbb44b09">More...</a><br /></td></tr>
<tr class="separator:a1aac44909f0ed34200901dc0fbb44b09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd712058e2ab0c92f6631fab9ed6f08"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#affd712058e2ab0c92f6631fab9ed6f08">UtilVmWrite64</a> (_In_ <a class="el" href="ia32__type_8h.html#a46733ebfd60eed3f1539af888cb983cb">VmcsField</a> field, _In_ ULONG64 field_value)</td></tr>
<tr class="memdesc:affd712058e2ab0c92f6631fab9ed6f08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes 64bit-width VMCS.  <a href="#affd712058e2ab0c92f6631fab9ed6f08">More...</a><br /></td></tr>
<tr class="separator:affd712058e2ab0c92f6631fab9ed6f08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a026bb72ff53d61008526d4f871360858"><td class="memItemLeft" align="right" valign="top">ULONG_PTR&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a026bb72ff53d61008526d4f871360858">UtilReadMsr</a> (_In_ <a class="el" href="ia32__type_8h.html#a65b496b2a5595032807adc67e57e2e9e">Msr</a> msr)</td></tr>
<tr class="memdesc:a026bb72ff53d61008526d4f871360858"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads natural-width MSR.  <a href="#a026bb72ff53d61008526d4f871360858">More...</a><br /></td></tr>
<tr class="separator:a026bb72ff53d61008526d4f871360858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bb012be6e532610840892e4148daeae"><td class="memItemLeft" align="right" valign="top">ULONG64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a7bb012be6e532610840892e4148daeae">UtilReadMsr64</a> (_In_ <a class="el" href="ia32__type_8h.html#a65b496b2a5595032807adc67e57e2e9e">Msr</a> msr)</td></tr>
<tr class="memdesc:a7bb012be6e532610840892e4148daeae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads 64bit-width MSR.  <a href="#a7bb012be6e532610840892e4148daeae">More...</a><br /></td></tr>
<tr class="separator:a7bb012be6e532610840892e4148daeae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcad69a3d6cc9a0b6ba840e01ecc39df"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#abcad69a3d6cc9a0b6ba840e01ecc39df">UtilWriteMsr</a> (_In_ <a class="el" href="ia32__type_8h.html#a65b496b2a5595032807adc67e57e2e9e">Msr</a> msr, _In_ ULONG_PTR value)</td></tr>
<tr class="memdesc:abcad69a3d6cc9a0b6ba840e01ecc39df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes natural-width MSR.  <a href="#abcad69a3d6cc9a0b6ba840e01ecc39df">More...</a><br /></td></tr>
<tr class="separator:abcad69a3d6cc9a0b6ba840e01ecc39df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b013a985bc97f755c42260932d54dae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a3b013a985bc97f755c42260932d54dae">UtilWriteMsr64</a> (_In_ <a class="el" href="ia32__type_8h.html#a65b496b2a5595032807adc67e57e2e9e">Msr</a> msr, _In_ ULONG64 value)</td></tr>
<tr class="memdesc:a3b013a985bc97f755c42260932d54dae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes 64bit-width MSR.  <a href="#a3b013a985bc97f755c42260932d54dae">More...</a><br /></td></tr>
<tr class="separator:a3b013a985bc97f755c42260932d54dae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26380029ce6cda809af3b6794674debd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a26380029ce6cda809af3b6794674debd">UtilInveptAll</a> ()</td></tr>
<tr class="memdesc:a26380029ce6cda809af3b6794674debd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the INVEPT instruction and invalidates EPT entry cache.  <a href="#a26380029ce6cda809af3b6794674debd">More...</a><br /></td></tr>
<tr class="separator:a26380029ce6cda809af3b6794674debd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795f2605d926d0ed4a75ca41046a1c21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="util_8h.html#a795f2605d926d0ed4a75ca41046a1c21">UtilLoadPdptes</a> (_In_ ULONG_PTR cr3_value)</td></tr>
<tr class="memdesc:a795f2605d926d0ed4a75ca41046a1c21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the PDPTE registers from CR3 to VMCS.  <a href="#a795f2605d926d0ed4a75ca41046a1c21">More...</a><br /></td></tr>
<tr class="separator:a795f2605d926d0ed4a75ca41046a1c21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a131ab25ba676523d82ffa34bfba7f79d"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a131ab25ba676523d82ffa34bfba7f79d"><td class="memTemplItemLeft" align="right" valign="top">constexpr bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="util_8h.html#a131ab25ba676523d82ffa34bfba7f79d">UtilIsInBounds</a> (_In_ const T &amp;value, _In_ const T &amp;min, _In_ const T &amp;max)</td></tr>
<tr class="memdesc:a131ab25ba676523d82ffa34bfba7f79d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests if <em>value</em> is in between <em>min</em> and <em>max</em>.  <a href="#a131ab25ba676523d82ffa34bfba7f79d">More...</a><br /></td></tr>
<tr class="separator:a131ab25ba676523d82ffa34bfba7f79d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declares interfaces to utility functions. </p>

<p>Definition in file <a class="el" href="util_8h_source.html">util.h</a>.</p>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="a939581b1de686b22b77e05cc403bfefc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a> : unsigned __int8</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indicates a result of VMX-instructions. </p>
<p>This convention was taken from the VMX-intrinsic functions by Microsoft. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="a939581b1de686b22b77e05cc403bfefcae69fa9a656f76dd8a4d89f21992b2d3a"></a>kOk&#160;</td><td class="fielddoc">
<p>Operation succeeded. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a939581b1de686b22b77e05cc403bfefcaf22dc5a4d384163b7540729085d894c1"></a>kErrorWithStatus&#160;</td><td class="fielddoc">
<p>Operation failed with extended status available. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="a939581b1de686b22b77e05cc403bfefca7bfc9e82422c34b573095e24a83b7315"></a>kErrorWithoutStatus&#160;</td><td class="fielddoc">
<p>Operation failed without status available. </p>
</td></tr>
</table>

<p>Definition at line <a class="el" href="util_8h_source.html#l00055">55</a> of file <a class="el" href="util_8h_source.html">util.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2d891c866238ad21fd5cba7d10394d40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">constexpr <a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a> operator|= </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a>&#160;</td>
          <td class="paramname"><em>lhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ <a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a>&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Provides |= operator for VmxStatus. </p>

<p>Definition at line <a class="el" href="util_8h_source.html#l00062">62</a> of file <a class="el" href="util_8h_source.html">util.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8bd8f1299edde15aad1cfba8551fc32f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* UtilAllocateContiguousMemory </td>
          <td>(</td>
          <td class="paramtype">_In_ SIZE_T&#160;</td>
          <td class="paramname"><em>number_of_bytes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates continuous physical memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">number_of_bytes</td><td>A size to allocate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A base address of an allocated memory or nullptr</dd></dl>
<p>A returned value must be freed with <a class="el" href="util_8h.html#a2473b98f948abe5e903993c0ce37ed7e" title="Frees an address allocated by UtilAllocateContiguousMemory() ">UtilFreeContiguousMemory()</a>. </p>

</div>
</div>
<a class="anchor" id="adaef3fe7b88b1a88248877c717dac8ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UtilDumpGpRegisters </td>
          <td>(</td>
          <td class="paramtype">_In_ const <a class="el" href="struct_all_registers.html">AllRegisters</a> *&#160;</td>
          <td class="paramname"><em>all_regs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ ULONG_PTR&#160;</td>
          <td class="paramname"><em>stack_pointer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Debug prints registers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">all_regs</td><td>Registers to print out </td></tr>
    <tr><td class="paramname">stack_pointer</td><td>A stack pointer before calling this function </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0aaa003c42756a8d0d878a024157ae61"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS UtilForEachProcessor </td>
          <td>(</td>
          <td class="paramtype">_In_ NTSTATUS(*)(void *)&#160;</td>
          <td class="paramname"><em>callback_routine</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_opt_ void *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes <em>callback_routine</em> on each processor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback_routine</td><td>A function to execute </td></tr>
    <tr><td class="paramname">context</td><td>An arbitrary parameter for <em>callback_routine</em> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>STATUS_SUCCESS when <em>returned</em> STATUS_SUCCESS on all processors</dd></dl>
<p><em>callback_routine</em> is executed on DISPATCH_LEVEL. </p>

</div>
</div>
<a class="anchor" id="a2473b98f948abe5e903993c0ce37ed7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UtilFreeContiguousMemory </td>
          <td>(</td>
          <td class="paramtype">_In_ void *&#160;</td>
          <td class="paramname"><em>base_address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees an address allocated by <a class="el" href="util_8h.html#a8bd8f1299edde15aad1cfba8551fc32f" title="Allocates continuous physical memory. ">UtilAllocateContiguousMemory()</a> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">base_address</td><td>A return value of <a class="el" href="util_8h.html#a8bd8f1299edde15aad1cfba8551fc32f" title="Allocates continuous physical memory. ">UtilAllocateContiguousMemory()</a> to free </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab9689b4a580d88e9e516e6081795de0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="struct_physical_memory_descriptor.html">PhysicalMemoryDescriptor</a>* UtilGetPhysicalMemoryRanges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns ranges of physical memory on the system. </p>
<dl class="section return"><dt>Returns</dt><dd>Physical memory ranges; never fails. </dd></dl>

<p>Definition at line <a class="el" href="util_8cpp_source.html#l00247">247</a> of file <a class="el" href="util_8cpp_source.html">util.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_ab9689b4a580d88e9e516e6081795de0d_icgraph.png" border="0" usemap="#util_8h_ab9689b4a580d88e9e516e6081795de0d_icgraph" alt=""/></div>
<map name="util_8h_ab9689b4a580d88e9e516e6081795de0d_icgraph" id="util_8h_ab9689b4a580d88e9e516e6081795de0d_icgraph">
<area shape="rect" id="node2" href="ept_8h.html#a21bd47144c33a9bec105e47f7d14d696" title="Builds EPT, allocates pre&#45;allocated enties, initializes and returns EptData. " alt="" coords="273,5,383,32"/>
<area shape="rect" id="node6" href="ept_8cpp.html#ac6d2a4ee32680eee9215d16e92f66751" title="EptpIsDeviceMemory" alt="" coords="256,56,400,83"/>
<area shape="rect" id="node3" href="vm_8cpp.html#a59a15f91f00f1b51f12580d106d8fd03" title="VmpInitializeSharedData" alt="" coords="448,5,612,32"/>
<area shape="rect" id="node4" href="vm_8h.html#a147812b07dd4d8cf330b225c912280c7" title="Virtualizes all processors. " alt="" coords="660,5,771,32"/>
<area shape="rect" id="node5" href="driver_8cpp.html#a7475895c182f826798d611e99cb56494" title="DriverEntry" alt="" coords="819,5,904,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4010ee7a299cbcb6c0aaf1290d5a7a73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* UtilGetSystemProcAddress </td>
          <td>(</td>
          <td class="paramtype">_In_ const wchar_t *&#160;</td>
          <td class="paramname"><em>proc_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get an address of an exported symbol by the kernel or HAL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">proc_name</td><td>A name of a symbol to locate an address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An address of the symbol or nullptr </dd></dl>

</div>
</div>
<a class="anchor" id="a726bcdba2e49ace860d6de5f443f5253"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS UtilInitialization </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Makes the Util functions ready for use. </p>
<dl class="section return"><dt>Returns</dt><dd>STATUS_SUCCESS on success </dd></dl>

<p>Definition at line <a class="el" href="util_8cpp_source.html#l00145">145</a> of file <a class="el" href="util_8cpp_source.html">util.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_a726bcdba2e49ace860d6de5f443f5253_cgraph.png" border="0" usemap="#util_8h_a726bcdba2e49ace860d6de5f443f5253_cgraph" alt=""/></div>
<map name="util_8h_a726bcdba2e49ace860d6de5f443f5253_cgraph" id="util_8h_a726bcdba2e49ace860d6de5f443f5253_cgraph">
<area shape="rect" id="node2" href="util_8cpp.html#aa77fccb47a21c49eace9b882dd376b71" title="UtilpInitializePhysicalMemory\lRanges" alt="" coords="163,5,355,47"/>
<area shape="rect" id="node3" href="util_8cpp.html#a01aa39e4193b223c65cd2c2ab89784e6" title="UtilpBuildPhysicalMemory\lRanges" alt="" coords="403,5,577,47"/>
<area shape="rect" id="node4" href="util_8cpp.html#a419ff5c4a24e27c03ea0b357b593805e" title="UtilPfnFromPa" alt="" coords="625,13,732,39"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_a726bcdba2e49ace860d6de5f443f5253_icgraph.png" border="0" usemap="#util_8h_a726bcdba2e49ace860d6de5f443f5253_icgraph" alt=""/></div>
<map name="util_8h_a726bcdba2e49ace860d6de5f443f5253_icgraph" id="util_8h_a726bcdba2e49ace860d6de5f443f5253_icgraph">
<area shape="rect" id="node2" href="driver_8cpp.html#a7475895c182f826798d611e99cb56494" title="DriverEntry" alt="" coords="163,5,248,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a26380029ce6cda809af3b6794674debd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a> UtilInveptAll </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes the INVEPT instruction and invalidates EPT entry cache. </p>
<dl class="section return"><dt>Returns</dt><dd>A result of the INVEPT instruction </dd></dl>

<p>Definition at line <a class="el" href="util_8cpp_source.html#l00641">641</a> of file <a class="el" href="util_8cpp_source.html">util.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_a26380029ce6cda809af3b6794674debd_cgraph.png" border="0" usemap="#util_8h_a26380029ce6cda809af3b6794674debd_cgraph" alt=""/></div>
<map name="util_8h_a26380029ce6cda809af3b6794674debd_cgraph" id="util_8h_a26380029ce6cda809af3b6794674debd_cgraph">
<area shape="rect" id="node2" href="asm_8h.html#ab081966c06c5956b992dc8086e1b1832" title="Invalidates translations derived from EPT. " alt="" coords="143,5,225,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_a26380029ce6cda809af3b6794674debd_icgraph.png" border="0" usemap="#util_8h_a26380029ce6cda809af3b6794674debd_icgraph" alt=""/></div>
<map name="util_8h_a26380029ce6cda809af3b6794674debd_icgraph" id="util_8h_a26380029ce6cda809af3b6794674debd_icgraph">
<area shape="rect" id="node2" href="ept_8cpp.html#a6adf0f9672ecc2605b2e73a3dea55468" title="EptHandleEptViolation" alt="" coords="143,5,295,32"/>
<area shape="rect" id="node4" href="vm_8cpp.html#aacdcc58a4e7aa6cdbc73c4ad94392ef1" title="VmpEnterVmxMode" alt="" coords="149,56,288,83"/>
<area shape="rect" id="node5" href="vmm_8cpp.html#aa8b54d75cffd4fdeccdd215427e42e9c" title="VmmpHandleVmCall" alt="" coords="147,107,290,133"/>
<area shape="rect" id="node3" href="vmm_8cpp.html#a572fdc29d1553bb115a734013c9d8df3" title="VmmpHandleEptViolation" alt="" coords="343,5,513,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a08e9aad496c6e45b9736641659914975"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UtilIsAccessibleAddress </td>
          <td>(</td>
          <td class="paramtype">_In_ void *&#160;</td>
          <td class="paramname"><em>address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks is the address is present on physical memory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">address</td><td>A virtual address to test </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the <em>address</em> is present on physical memory </dd></dl>

</div>
</div>
<a class="anchor" id="a131ab25ba676523d82ffa34bfba7f79d"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">constexpr bool UtilIsInBounds </td>
          <td>(</td>
          <td class="paramtype">_In_ const T &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const T &amp;&#160;</td>
          <td class="paramname"><em>min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const T &amp;&#160;</td>
          <td class="paramname"><em>max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests if <em>value</em> is in between <em>min</em> and <em>max</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">value</td><td>A value to test </td></tr>
    <tr><td class="paramname">min</td><td>A minimum acceptable value </td></tr>
    <tr><td class="paramname">max</td><td>A maximum acceptable value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if <em>value</em> is in between <em>min</em> and <em>max</em> </dd></dl>

<p>Definition at line <a class="el" href="util_8h_source.html#l00250">250</a> of file <a class="el" href="util_8h_source.html">util.h</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_a131ab25ba676523d82ffa34bfba7f79d_icgraph.png" border="0" usemap="#util_8h_a131ab25ba676523d82ffa34bfba7f79d_icgraph" alt=""/></div>
<map name="util_8h_a131ab25ba676523d82ffa34bfba7f79d_icgraph" id="util_8h_a131ab25ba676523d82ffa34bfba7f79d_icgraph">
<area shape="rect" id="node2" href="ept_8cpp.html#ac6d2a4ee32680eee9215d16e92f66751" title="EptpIsDeviceMemory" alt="" coords="170,5,314,32"/>
<area shape="rect" id="node3" href="util_8cpp.html#ae5f3bed18bc64deebf3330745f89cd63" title="UtilVmRead64" alt="" coords="189,56,295,83"/>
<area shape="rect" id="node6" href="util_8cpp.html#ae65d5947062aa3b6e2970a01c9a3474d" title="UtilVmWrite64" alt="" coords="189,107,295,133"/>
<area shape="rect" id="node10" href="vmm_8cpp.html#a4e2648ac690734fd8b65292b3345fef1" title="VmmpHandleMsrAccess" alt="" coords="159,157,325,184"/>
<area shape="rect" id="node4" href="ept_8cpp.html#a6adf0f9672ecc2605b2e73a3dea55468" title="EptHandleEptViolation" alt="" coords="373,56,525,83"/>
<area shape="rect" id="node5" href="vmm_8cpp.html#a572fdc29d1553bb115a734013c9d8df3" title="VmmpHandleEptViolation" alt="" coords="573,56,744,83"/>
<area shape="rect" id="node7" href="util_8cpp.html#a15f26bbfcd972225444b7a4736cb365c" title="UtilLoadPdptes" alt="" coords="394,157,505,184"/>
<area shape="rect" id="node8" href="vm_8cpp.html#a52414afdd39151cf7b1e12a37f34abda" title="VmpSetupVMCS" alt="" coords="598,107,719,133"/>
<area shape="rect" id="node9" href="vmm_8cpp.html#a8fb9289d967c49d8900b22df4dc1911a" title="VmmpHandleCrAccess" alt="" coords="580,157,737,184"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad8434ca108fb47650842faded523d9c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool UtilIsX86Pae </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks if the system is a PAE-enabled x86 system. </p>
<dl class="section return"><dt>Returns</dt><dd>true if the system is a PAE-enabled x86 system </dd></dl>

<p>Definition at line <a class="el" href="util_8cpp_source.html#l00313">313</a> of file <a class="el" href="util_8cpp_source.html">util.cpp</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_ad8434ca108fb47650842faded523d9c4_cgraph.png" border="0" usemap="#util_8h_ad8434ca108fb47650842faded523d9c4_cgraph" alt=""/></div>
<map name="util_8h_ad8434ca108fb47650842faded523d9c4_cgraph" id="util_8h_ad8434ca108fb47650842faded523d9c4_cgraph">
<area shape="rect" id="node2" href="common_8h.html#ae06c86efd7f271e00cb4f501fbca6e1a" title="Checks if a system is x64. " alt="" coords="148,5,201,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_ad8434ca108fb47650842faded523d9c4_icgraph.png" border="0" usemap="#util_8h_ad8434ca108fb47650842faded523d9c4_icgraph" alt=""/></div>
<map name="util_8h_ad8434ca108fb47650842faded523d9c4_icgraph" id="util_8h_ad8434ca108fb47650842faded523d9c4_icgraph">
<area shape="rect" id="node2" href="util_8cpp.html#a8674c4ce7bf08bc059b970996d689f25" title="UtilIsAccessibleAddress" alt="" coords="148,5,311,32"/>
<area shape="rect" id="node3" href="vm_8cpp.html#a52414afdd39151cf7b1e12a37f34abda" title="VmpSetupVMCS" alt="" coords="169,56,290,83"/>
<area shape="rect" id="node4" href="vmm_8cpp.html#a8fb9289d967c49d8900b22df4dc1911a" title="VmmpHandleCrAccess" alt="" coords="151,107,308,133"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a795f2605d926d0ed4a75ca41046a1c21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UtilLoadPdptes </td>
          <td>(</td>
          <td class="paramtype">_In_ ULONG_PTR&#160;</td>
          <td class="paramname"><em>cr3_value</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the PDPTE registers from CR3 to VMCS. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cr3_value</td><td>CR3 value to retrive PDPTEs </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a32e9f8e1d8f7224f39defe4075d64fd1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* UtilMemMem </td>
          <td>(</td>
          <td class="paramtype">_In_ const void *&#160;</td>
          <td class="paramname"><em>search_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ SIZE_T&#160;</td>
          <td class="paramname"><em>search_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ const void *&#160;</td>
          <td class="paramname"><em>pattern</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ SIZE_T&#160;</td>
          <td class="paramname"><em>pattern_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searchs a byte pattern from a given address range. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">search_base</td><td>An address to start search </td></tr>
    <tr><td class="paramname">search_size</td><td>A length to search in bytes </td></tr>
    <tr><td class="paramname">pattern</td><td>A byte pattern to search </td></tr>
    <tr><td class="paramname">pattern_size</td><td>A size of <em>pattern</em> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An address of the first occurence of the patten if found, or nullptr </dd></dl>

</div>
</div>
<a class="anchor" id="ab74c0627dc9924818519701853229222"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG64 UtilPaFromPfn </td>
          <td>(</td>
          <td class="paramtype">_In_ PFN_NUMBER&#160;</td>
          <td class="paramname"><em>pfn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PNF -&gt; PA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pfn</td><td>A page frame number to get its physical address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pysical address of <em>pfn</em> </dd></dl>

</div>
</div>
<a class="anchor" id="a92592f53709118b3e50ee7ae7229740d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG64 UtilPaFromVa </td>
          <td>(</td>
          <td class="paramtype">_In_ void *&#160;</td>
          <td class="paramname"><em>va</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>VA -&gt; PA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">va</td><td>A virtual address to get its physical address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pysical address of <em>va</em>, or nullptr</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>It cannot be used for a virtual address managed by a prototype PTE. </dd></dl>

</div>
</div>
<a class="anchor" id="a647d0431c628fe6bceb8f14bc94b21b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PFN_NUMBER UtilPfnFromPa </td>
          <td>(</td>
          <td class="paramtype">_In_ ULONG64&#160;</td>
          <td class="paramname"><em>pa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PA -&gt; PFN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pa</td><td>A pysical address to get its page frame number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A page frame number of <em>pa</em>, or 0 </dd></dl>

</div>
</div>
<a class="anchor" id="ae40894c3616c3b42f07abe8f7318c843"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PFN_NUMBER UtilPfnFromVa </td>
          <td>(</td>
          <td class="paramtype">_In_ void *&#160;</td>
          <td class="paramname"><em>va</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>VA -&gt; PFN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">va</td><td>A virtual address to get its physical address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A page frame number of <em>va</em>, or 0</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>It cannot be used for a virtual address managed by a prototype PTE. </dd></dl>

</div>
</div>
<a class="anchor" id="a026bb72ff53d61008526d4f871360858"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG_PTR UtilReadMsr </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="ia32__type_8h.html#a65b496b2a5595032807adc67e57e2e9e">Msr</a>&#160;</td>
          <td class="paramname"><em>msr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads natural-width MSR. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msr</td><td>MSR to read </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>read value </dd></dl>

</div>
</div>
<a class="anchor" id="a7bb012be6e532610840892e4148daeae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG64 UtilReadMsr64 </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="ia32__type_8h.html#a65b496b2a5595032807adc67e57e2e9e">Msr</a>&#160;</td>
          <td class="paramname"><em>msr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads 64bit-width MSR. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msr</td><td>MSR to read </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>read value </dd></dl>

</div>
</div>
<a class="anchor" id="aa3191572ccb702eea4c5845531d009ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS UtilSleep </td>
          <td>(</td>
          <td class="paramtype">_In_ LONG&#160;</td>
          <td class="paramname"><em>millisecond</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Suspends the execution of the current thread. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">millisecond</td><td>Time to suspend in milliseconds </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>STATUS_SUCCESS on success </dd></dl>

</div>
</div>
<a class="anchor" id="a9eec12475580085fab5c154f681d59a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UtilTermination </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees all resources allocated for the sake of the Util funcions. </p>

<p>Definition at line <a class="el" href="util_8cpp_source.html#l00157">157</a> of file <a class="el" href="util_8cpp_source.html">util.cpp</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="util_8h_a9eec12475580085fab5c154f681d59a5_icgraph.png" border="0" usemap="#util_8h_a9eec12475580085fab5c154f681d59a5_icgraph" alt=""/></div>
<map name="util_8h_a9eec12475580085fab5c154f681d59a5_icgraph" id="util_8h_a9eec12475580085fab5c154f681d59a5_icgraph">
<area shape="rect" id="node2" href="driver_8cpp.html#a7475895c182f826798d611e99cb56494" title="DriverEntry" alt="" coords="185,5,271,32"/>
<area shape="rect" id="node3" href="driver_8cpp.html#a601ab246ef7b8990c3aaec46ab1c1c3d" title="DriverpDriverUnload" alt="" coords="161,56,295,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a09515f13e88dde436aa2c096765af41c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* UtilVaFromPa </td>
          <td>(</td>
          <td class="paramtype">_In_ ULONG64&#160;</td>
          <td class="paramname"><em>pa</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PA -&gt; VA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pa</td><td>A pysical address to get its virtual address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A virtual address <em>pa</em>, or 0 </dd></dl>

</div>
</div>
<a class="anchor" id="ab201d9452d8e211487bdf98032190b3d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* UtilVaFromPfn </td>
          <td>(</td>
          <td class="paramtype">_In_ PFN_NUMBER&#160;</td>
          <td class="paramname"><em>pfn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PNF -&gt; VA. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pfn</td><td>A page frame number to get its virtual address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A virtual address of <em>pfn</em> </dd></dl>

</div>
</div>
<a class="anchor" id="a4b65dcf2f010be518a04a714117d76b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NTSTATUS UtilVmCall </td>
          <td>(</td>
          <td class="paramtype">_In_ ULONG_PTR&#160;</td>
          <td class="paramname"><em>hypercall_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_opt_ void *&#160;</td>
          <td class="paramname"><em>context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes VMCALL. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hypercall_number</td><td>A command number </td></tr>
    <tr><td class="paramname">context</td><td>An arbitrary parameter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>STATUS_SUCCESS if VMXON instruction succedded </dd></dl>

</div>
</div>
<a class="anchor" id="a146843c664ad83867ad5063ea122bc64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG_PTR UtilVmRead </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="ia32__type_8h.html#a46733ebfd60eed3f1539af888cb983cb">VmcsField</a>&#160;</td>
          <td class="paramname"><em>field</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads natural-width VMCS. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>VMCS-field to read </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>read value </dd></dl>

</div>
</div>
<a class="anchor" id="a53c0c66fa501f754e718e27e559cd6c0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ULONG64 UtilVmRead64 </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="ia32__type_8h.html#a46733ebfd60eed3f1539af888cb983cb">VmcsField</a>&#160;</td>
          <td class="paramname"><em>field</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads 64bit-width VMCS. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>VMCS-field to read </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>read value </dd></dl>

</div>
</div>
<a class="anchor" id="a1aac44909f0ed34200901dc0fbb44b09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a> UtilVmWrite </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="ia32__type_8h.html#a46733ebfd60eed3f1539af888cb983cb">VmcsField</a>&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ ULONG_PTR&#160;</td>
          <td class="paramname"><em>field_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes natural-width VMCS. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>VMCS-field to write </td></tr>
    <tr><td class="paramname">field_value</td><td>A value to write </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A result of the VMWRITE instruction </dd></dl>

</div>
</div>
<a class="anchor" id="affd712058e2ab0c92f6631fab9ed6f08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="util_8h.html#a939581b1de686b22b77e05cc403bfefc">VmxStatus</a> UtilVmWrite64 </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="ia32__type_8h.html#a46733ebfd60eed3f1539af888cb983cb">VmcsField</a>&#160;</td>
          <td class="paramname"><em>field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ ULONG64&#160;</td>
          <td class="paramname"><em>field_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes 64bit-width VMCS. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">field</td><td>VMCS-field to write </td></tr>
    <tr><td class="paramname">field_value</td><td>A value to write </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A result of the VMWRITE instruction </dd></dl>

</div>
</div>
<a class="anchor" id="abcad69a3d6cc9a0b6ba840e01ecc39df"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UtilWriteMsr </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="ia32__type_8h.html#a65b496b2a5595032807adc67e57e2e9e">Msr</a>&#160;</td>
          <td class="paramname"><em>msr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ ULONG_PTR&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes natural-width MSR. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msr</td><td>MSR to write </td></tr>
    <tr><td class="paramname">value</td><td>A value to write </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3b013a985bc97f755c42260932d54dae"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UtilWriteMsr64 </td>
          <td>(</td>
          <td class="paramtype">_In_ <a class="el" href="ia32__type_8h.html#a65b496b2a5595032807adc67e57e2e9e">Msr</a>&#160;</td>
          <td class="paramname"><em>msr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ ULONG64&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes 64bit-width MSR. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msr</td><td>MSR to write </td></tr>
    <tr><td class="paramname">value</td><td>A value to write </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
